{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T09:30:30.852Z"}}
{"level":"info","message":{"alertId":"test-alert-1","alertType":"critical","context":"MockEmailNotification","message":"開発モードでメール送信をシミュレーション","mockEmail":{"body":"\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2 style=\"color: #FF0000; border-bottom: 2px solid #FF0000; padding-bottom: 10px;\">\n          緊急 Alert\n        </h2>\n        <div style=\"margin: 20px 0;\">\n          <p><strong>Source:</strong> test-monitor</p>\n          <p><strong>Message:</strong> Test alert message</p>\n          <p><strong>Timestamp:</strong> 2025/3/8 18:30:30</p>\n        </div>\n        \n      </div>\n    ","subject":"[CRITICAL] System Alert: test-monitor"}},"metadata":{"timestamp":"2025-03-08T09:30:30.907Z"}}
{"level":"info","message":{"alertId":"test-alert-2","alertType":"warning","context":"MockEmailNotification","message":"開発モードでメール送信をシミュレーション","mockEmail":{"body":"\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2 style=\"color: #FFBB33; border-bottom: 2px solid #FFBB33; padding-bottom: 10px;\">\n          警告 Alert\n        </h2>\n        <div style=\"margin: 20px 0;\">\n          <p><strong>Source:</strong> test-monitor</p>\n          <p><strong>Message:</strong> Test warning message</p>\n          <p><strong>Timestamp:</strong> 2025/3/8 18:30:30</p>\n        </div>\n        \n      </div>\n    ","subject":"[WARNING] System Alert: test-monitor"}},"metadata":{"timestamp":"2025-03-08T09:30:30.927Z"}}
{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T09:30:30.922Z"}}
{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T09:30:31.099Z"}}
{"level":"info","message":{"message":"AuditMetricsService initialized"},"metadata":{"timestamp":"2025-03-08T09:30:31.149Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","details":{"actorEmail":"' OR '1'='1"},"message":"Failed to search audit records"},"error":{"message":"Invalid email format","name":"Error","stack":"Error: Invalid email format\n    at PermissionAuditService.validateAuditFilter (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\permissionAuditService.ts:300:13)\n    at PermissionAuditService.validateAuditFilter [as searchAuditRecords] (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\permissionAuditService.ts:316:12)\n    at Object.<anonymous> (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\__tests__\\security\\permissionAudit.security.test.ts:40:33)\n    at Promise.then.completed (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at _runTest (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"},"timestamp":"2025-03-08T09:30:31.168Z","type":"error"}}
{"level":"info","message":{"message":"AuditMetricsService initialized"},"metadata":{"timestamp":"2025-03-08T09:30:31.220Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","message":"Failed to fetch global admins"},"error":{"message":"SQLITE_ERROR: no such table: users","name":"Error","stack":"Error: SQLITE_ERROR: no such table: users"},"timestamp":"2025-03-08T09:30:31.222Z","type":"error"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","message":"Failed to initialize audit database tables"},"error":{"message":"SQLITE_ERROR: no such table: main.permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: main.permission_audit"},"timestamp":"2025-03-08T09:30:31.230Z","type":"error"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","details":{"actor":"actor@example.com","target":"target@example.com"},"message":"Failed to send permission change notification"},"error":{"message":"this.notificationService.sendNotification is not a function","name":"TypeError","stack":"TypeError: this.notificationService.sendNotification is not a function\n    at PermissionAuditService.sendNotification [as notifyPermissionChange] (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\permissionAuditService.ts:236:40)\n    at PermissionAuditService.recordChange (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\permissionAuditService.ts:160:7)\n    at Object.<anonymous> (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\__tests__\\security\\permissionAudit.security.test.ts:47:22)"},"timestamp":"2025-03-08T09:30:31.265Z","type":"error"}}
{"level":"info","message":{"details":{"action":"add","actor":"actor@example.com","resourceType":"role","target":"target@example.com"},"message":"Permission change recorded"},"metadata":{"timestamp":"2025-03-08T09:30:31.267Z"}}
{"level":"info","message":{"message":"PermissionAuditService initialized - Database tables created"},"metadata":{"timestamp":"2025-03-08T09:30:31.352Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","message":"Failed to fetch global admins"},"error":{"message":"SQLITE_ERROR: no such table: users","name":"Error","stack":"Error: SQLITE_ERROR: no such table: users"},"timestamp":"2025-03-08T09:30:31.415Z","type":"error"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","details":{"actor":"actor@example.com","target":"target@example.com"},"message":"Failed to send permission change notification"},"error":{"message":"this.notificationService.sendNotification is not a function","name":"TypeError","stack":"TypeError: this.notificationService.sendNotification is not a function\n    at PermissionAuditService.sendNotification [as notifyPermissionChange] (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\permissionAuditService.ts:236:40)\n    at PermissionAuditService.recordChange (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\permissionAuditService.ts:160:7)\n    at Object.<anonymous> (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\__tests__\\security\\permissionAudit.security.test.ts:98:22)"},"timestamp":"2025-03-08T09:30:31.417Z","type":"error"}}
{"level":"info","message":{"details":{"action":"add","actor":"actor@example.com","resourceType":"role","target":"target@example.com"},"message":"Permission change recorded"},"metadata":{"timestamp":"2025-03-08T09:30:31.418Z"}}
{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T09:30:39.235Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","details":{"actor":"actor0@example.com","target":"target0@example.com"},"message":"Failed to record permission change"},"error":{"message":"SQLITE_ERROR: no such table: permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: permission_audit"},"timestamp":"2025-03-08T09:30:39.278Z","type":"error"}}
{"level":"info","message":{"message":"AuditMetricsService initialized"},"metadata":{"timestamp":"2025-03-08T09:30:39.311Z"}}
{"level":"info","message":{"message":"PermissionAuditService initialized - Database tables created"},"metadata":{"timestamp":"2025-03-08T09:30:39.338Z"}}
{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T09:38:26.249Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","details":{"actor":"actor0@example.com","target":"target0@example.com"},"message":"Failed to record permission change"},"error":{"message":"SQLITE_ERROR: no such table: permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: permission_audit"},"timestamp":"2025-03-08T09:38:26.303Z","type":"error"}}
{"level":"info","message":{"message":"AuditMetricsService initialized"},"metadata":{"timestamp":"2025-03-08T09:38:26.384Z"}}
{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T09:38:26.378Z"}}
{"level":"info","message":{"message":"AuditMetricsService initialized"},"metadata":{"timestamp":"2025-03-08T09:38:26.653Z"}}
{"level":"info","message":{"message":"PermissionAuditService initialized - Database tables created"},"metadata":{"timestamp":"2025-03-08T09:38:27.205Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","message":"Failed to initialize audit database tables"},"error":{"message":"SQLITE_ERROR: no such table: main.permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: main.permission_audit"},"timestamp":"2025-03-08T09:38:30.549Z","type":"error"}}
{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T09:40:55.322Z"}}
{"level":"info","message":{"message":"AuditMetricsService initialized"},"metadata":{"timestamp":"2025-03-08T09:40:55.509Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","message":"Failed to initialize audit database tables"},"error":{"message":"SQLITE_ERROR: no such table: main.permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: main.permission_audit"},"timestamp":"2025-03-08T09:40:55.533Z","type":"error"}}
{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T09:40:55.865Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","details":{"actor":"actor0@example.com","target":"target0@example.com"},"message":"Failed to record permission change"},"error":{"message":"SQLITE_ERROR: no such table: permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: permission_audit"},"timestamp":"2025-03-08T09:40:55.920Z","type":"error"}}
{"level":"info","message":{"message":"AuditMetricsService initialized"},"metadata":{"timestamp":"2025-03-08T09:40:55.966Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","message":"Failed to initialize audit database tables"},"error":{"message":"SQLITE_ERROR: no such table: main.permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: main.permission_audit"},"timestamp":"2025-03-08T09:40:56.249Z","type":"error"}}
{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T09:43:35.195Z"}}
{"level":"info","message":{"message":"AuditMetricsService initialized"},"metadata":{"timestamp":"2025-03-08T09:43:35.436Z"}}
{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T09:43:35.396Z"}}
{"level":"info","message":{"message":"AuditMetricsService initialized"},"metadata":{"timestamp":"2025-03-08T09:43:35.511Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","message":"Failed to fetch global admins"},"error":{"message":"SQLITE_ERROR: no such table: users","name":"Error","stack":"Error: SQLITE_ERROR: no such table: users"},"timestamp":"2025-03-08T09:43:35.521Z","type":"error"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","details":{"actor":"actor0@example.com","target":"target0@example.com"},"message":"Failed to send permission change notification"},"error":{"message":"this.notificationService.sendNotification is not a function","name":"TypeError","stack":"TypeError: this.notificationService.sendNotification is not a function\n    at PermissionAuditService.sendNotification [as notifyPermissionChange] (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\permissionAuditService.ts:253:40)\n    at PermissionAuditService.recordChange (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\permissionAuditService.ts:177:7)\n    at generateTestData (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\__tests__\\permissionAuditPerformance.test.ts:24:7)\n    at Object.<anonymous> (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\__tests__\\permissionAuditPerformance.test.ts:14:5)"},"timestamp":"2025-03-08T09:43:35.669Z","type":"error"}}
{"level":"info","message":{"details":{"action":"add","actor":"actor0@example.com","resourceType":"role","target":"target0@example.com"},"message":"Permission change recorded"},"metadata":{"timestamp":"2025-03-08T09:43:35.672Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","details":{"actor":"actor1@example.com","target":"target1@example.com"},"message":"Failed to record permission change"},"error":{"message":"SQLITE_ERROR: no such table: permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: permission_audit"},"timestamp":"2025-03-08T09:43:35.732Z","type":"error"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","message":"Failed to initialize audit database tables"},"error":{"message":"SQLITE_ERROR: no such table: main.permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: main.permission_audit"},"timestamp":"2025-03-08T09:43:35.740Z","type":"error"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","message":"Failed to initialize audit database tables"},"error":{"message":"SQLITE_ERROR: no such table: main.permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: main.permission_audit"},"timestamp":"2025-03-08T09:43:35.801Z","type":"error"}}
{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T09:43:45.722Z"}}
{"level":"info","message":{"message":"AuditMetricsService initialized"},"metadata":{"timestamp":"2025-03-08T09:43:45.805Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","message":"Failed to initialize audit database tables"},"error":{"message":"SQLITE_ERROR: no such table: main.permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: main.permission_audit"},"timestamp":"2025-03-08T09:43:45.880Z","type":"error"}}
{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T09:50:49.935Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","details":{"actor":"actor0@example.com","target":"target0@example.com"},"message":"Failed to record permission change"},"error":{"message":"SQLITE_ERROR: no such table: permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: permission_audit"},"timestamp":"2025-03-08T09:50:49.948Z","type":"error"}}
{"level":"info","message":{"message":"AuditMetricsService initialized"},"metadata":{"timestamp":"2025-03-08T09:50:49.998Z"}}
{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T09:50:49.975Z"}}
{"level":"info","message":{"message":"AuditMetricsService initialized"},"metadata":{"timestamp":"2025-03-08T09:50:50.180Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","message":"Failed to initialize audit database tables"},"error":{"message":"SQLITE_ERROR: no such table: main.permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: main.permission_audit"},"timestamp":"2025-03-08T09:50:50.188Z","type":"error"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","message":"Failed to initialize audit database tables"},"error":{"message":"SQLITE_ERROR: no such table: main.permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: main.permission_audit"},"timestamp":"2025-03-08T09:50:50.199Z","type":"error"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"SQLiteService","message":"データベース初期化エラー"},"error":{"message":"this.db.exec is not a function","name":"TypeError","stack":"TypeError: this.db.exec is not a function\n    at SQLiteService.exec [as initializeDatabase] (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\sqliteService.ts:25:15)\n    at new initializeDatabase (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\sqliteService.ts:14:10)\n    at Function.getInstance (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\sqliteService.ts:37:32)\n    at Object.<anonymous> (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\tests\\setup.ts:20:30)\n    at Promise.then.completed (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTestsForDescribeBlock (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"},"timestamp":"2025-03-08T09:50:56.496Z","type":"error"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"SQLiteService","message":"データベース初期化エラー"},"error":{"message":"this.db.exec is not a function","name":"TypeError","stack":"TypeError: this.db.exec is not a function\n    at SQLiteService.exec [as initializeDatabase] (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\sqliteService.ts:25:15)\n    at new initializeDatabase (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\sqliteService.ts:14:10)\n    at Function.getInstance (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\sqliteService.ts:37:32)\n    at Object.<anonymous> (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\tests\\setup.ts:96:30)\n    at Promise.then.completed (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTestsForDescribeBlock (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:154:7)\n    at run (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"},"timestamp":"2025-03-08T09:50:56.522Z","type":"error"}}
{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T11:28:21.201Z"}}
{"level":"info","message":{"message":"AuditMetricsService initialized"},"metadata":{"timestamp":"2025-03-08T11:28:21.477Z"}}
{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T11:28:21.511Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","details":{"actor":"actor0@example.com","target":"target0@example.com"},"message":"Failed to record permission change"},"error":{"message":"SQLITE_ERROR: no such table: permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: permission_audit"},"timestamp":"2025-03-08T11:28:21.525Z","type":"error"}}
{"level":"info","message":{"message":"AuditMetricsService initialized"},"metadata":{"timestamp":"2025-03-08T11:28:21.620Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","message":"Failed to initialize audit database tables"},"error":{"message":"SQLITE_ERROR: no such table: main.permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: main.permission_audit"},"timestamp":"2025-03-08T11:28:21.662Z","type":"error"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","message":"Failed to initialize audit database tables"},"error":{"message":"SQLITE_ERROR: no such table: main.permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: main.permission_audit"},"timestamp":"2025-03-08T11:28:21.798Z","type":"error"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"SQLiteService","message":"データベース初期化エラー"},"error":{"message":"this.db.exec is not a function","name":"TypeError","stack":"TypeError: this.db.exec is not a function\n    at SQLiteService.exec [as initializeDatabase] (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\sqliteService.ts:25:15)\n    at new initializeDatabase (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\sqliteService.ts:14:10)\n    at Function.getInstance (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\sqliteService.ts:37:32)\n    at Object.<anonymous> (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\tests\\setup.ts:20:30)\n    at Promise.then.completed (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTestsForDescribeBlock (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"},"timestamp":"2025-03-08T11:28:22.161Z","type":"error"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"SQLiteService","message":"データベース初期化エラー"},"error":{"message":"this.db.exec is not a function","name":"TypeError","stack":"TypeError: this.db.exec is not a function\n    at SQLiteService.exec [as initializeDatabase] (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\sqliteService.ts:25:15)\n    at new initializeDatabase (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\sqliteService.ts:14:10)\n    at Function.getInstance (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\services\\sqliteService.ts:37:32)\n    at Object.<anonymous> (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\src\\tests\\setup.ts:96:30)\n    at Promise.then.completed (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTestsForDescribeBlock (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:154:7)\n    at run (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\kitting\\ITManagementSystem\\03_実装\\it-ops-system\\backend\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"},"timestamp":"2025-03-08T11:28:22.191Z","type":"error"}}
{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T11:28:31.623Z"}}
{"level":"info","message":{"message":"AuditMetricsService initialized"},"metadata":{"timestamp":"2025-03-08T11:28:31.733Z"}}
{"level":"info","message":{"context":"GraphClientInit","message":"開発モードでGraph Clientをモックに設定しました"},"metadata":{"timestamp":"2025-03-08T11:28:31.821Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","details":{"actor":"actor0@example.com","target":"target0@example.com"},"message":"Failed to record permission change"},"error":{"message":"SQLITE_ERROR: no such table: permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: permission_audit"},"timestamp":"2025-03-08T11:28:31.837Z","type":"error"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","message":"Failed to initialize audit database tables"},"error":{"message":"SQLITE_ERROR: no such table: main.permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: main.permission_audit"},"timestamp":"2025-03-08T11:28:31.854Z","type":"error"}}
{"level":"info","message":{"message":"AuditMetricsService initialized"},"metadata":{"timestamp":"2025-03-08T11:28:31.855Z"}}
{"level":"error","message":"Error","metadata":{"context":{"context":"PermissionAuditService","message":"Failed to initialize audit database tables"},"error":{"message":"SQLITE_ERROR: no such table: main.permission_audit","name":"Error","stack":"Error: SQLITE_ERROR: no such table: main.permission_audit"},"timestamp":"2025-03-08T11:28:31.969Z","type":"error"}}
