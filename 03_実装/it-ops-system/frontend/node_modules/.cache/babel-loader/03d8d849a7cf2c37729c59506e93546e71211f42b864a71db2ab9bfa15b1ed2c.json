{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Chart as ChartJS,CategoryScale,LinearScale,PointElement,LineElement,Title,Tooltip,Legend}from'chart.js';import{Line}from'react-chartjs-2';import{Box,useTheme}from'@mui/material';import{jsx as _jsx}from\"react/jsx-runtime\";ChartJS.register(CategoryScale,LinearScale,PointElement,LineElement,Title,Tooltip,Legend);const MetricsChart=_ref=>{let{data}=_ref;const theme=useTheme();const[chartData,setChartData]=useState({labels:[],datasets:[]});const bytesToMbps=bytes=>{return Number((bytes*8/1000000).toFixed(2));};const bytesToGB=bytes=>{return Number((bytes/(1024*1024*1024)).toFixed(2));};useEffect(()=>{setChartData(prevData=>{var _prevData$datasets$,_prevData$datasets$2,_prevData$datasets$3,_prevData$datasets$4;const now=new Date();const labels=[...prevData.labels.slice(-19),now.toLocaleTimeString('ja-JP')];const cpuData=[...(((_prevData$datasets$=prevData.datasets[0])===null||_prevData$datasets$===void 0?void 0:_prevData$datasets$.data)||[]).slice(-19),data.cpu.usage].slice(-20);const memoryData=[...(((_prevData$datasets$2=prevData.datasets[1])===null||_prevData$datasets$2===void 0?void 0:_prevData$datasets$2.data)||[]).slice(-19),data.memory.used/data.memory.total*100].slice(-20);const networkInData=[...(((_prevData$datasets$3=prevData.datasets[2])===null||_prevData$datasets$3===void 0?void 0:_prevData$datasets$3.data)||[]).slice(-19),bytesToMbps(data.network.bytesIn)].slice(-20);const networkOutData=[...(((_prevData$datasets$4=prevData.datasets[3])===null||_prevData$datasets$4===void 0?void 0:_prevData$datasets$4.data)||[]).slice(-19),bytesToMbps(data.network.bytesOut)].slice(-20);return{labels,datasets:[{label:'CPU使用率 (%)',data:cpuData,borderColor:theme.palette.primary.main,backgroundColor:theme.palette.primary.light,fill:false,tension:0.4,borderWidth:2},{label:'メモリ使用率 (%)',data:memoryData,borderColor:theme.palette.secondary.main,backgroundColor:theme.palette.secondary.light,fill:false,tension:0.4,borderWidth:2},{label:'ネットワーク受信 (Mbps)',data:networkInData,borderColor:theme.palette.success.main,backgroundColor:theme.palette.success.light,fill:false,tension:0.4,borderWidth:2},{label:'ネットワーク送信 (Mbps)',data:networkOutData,borderColor:theme.palette.warning.main,backgroundColor:theme.palette.warning.light,fill:false,tension:0.4,borderWidth:2}]};});},[data,theme.palette]);const options={responsive:true,maintainAspectRatio:false,animation:{duration:300},scales:{y:{beginAtZero:true,grid:{color:'rgba(0, 0, 0, 0.05)'},ticks:{callback:function(value){return value.toString();},color:theme.palette.text.secondary}},x:{grid:{display:false},ticks:{color:theme.palette.text.secondary,maxRotation:45,minRotation:45}}},plugins:{legend:{position:'top',labels:{usePointStyle:true,padding:20,font:{size:12},color:theme.palette.text.primary}},title:{display:false},tooltip:{mode:'index',intersect:false,backgroundColor:'rgba(255, 255, 255, 0.9)',titleColor:theme.palette.text.primary,bodyColor:theme.palette.text.secondary,borderColor:'rgba(0, 0, 0, 0.1)',borderWidth:1}},interaction:{mode:'nearest',axis:'x',intersect:false}};return/*#__PURE__*/_jsx(Box,{sx:{width:'100%',height:400,p:2,backgroundColor:'#ffffff',borderRadius:1,boxShadow:'0 0 10px rgba(0,0,0,0.1) inset'},children:/*#__PURE__*/_jsx(Line,{data:chartData,options:options})});};export default MetricsChart;","map":{"version":3,"names":["React","useEffect","useState","Chart","ChartJS","CategoryScale","LinearScale","PointElement","LineElement","Title","Tooltip","Legend","Line","Box","useTheme","jsx","_jsx","register","MetricsChart","_ref","data","theme","chartData","setChartData","labels","datasets","bytesToMbps","bytes","Number","toFixed","bytesToGB","prevData","_prevData$datasets$","_prevData$datasets$2","_prevData$datasets$3","_prevData$datasets$4","now","Date","slice","toLocaleTimeString","cpuData","cpu","usage","memoryData","memory","used","total","networkInData","network","bytesIn","networkOutData","bytesOut","label","borderColor","palette","primary","main","backgroundColor","light","fill","tension","borderWidth","secondary","success","warning","options","responsive","maintainAspectRatio","animation","duration","scales","y","beginAtZero","grid","color","ticks","callback","value","toString","text","x","display","maxRotation","minRotation","plugins","legend","position","usePointStyle","padding","font","size","title","tooltip","mode","intersect","titleColor","bodyColor","interaction","axis","sx","width","height","p","borderRadius","boxShadow","children"],"sources":["E:/IT運用システム/03_実装/it-ops-system/frontend/src/components/dashboard/MetricsChart.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport {\r\n  Chart as ChartJS,\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n  ChartOptions,\r\n} from 'chart.js';\r\nimport { Line } from 'react-chartjs-2';\r\nimport { Box, useTheme } from '@mui/material';\r\nimport { SystemMetrics } from '../../types/api';\r\n\r\nChartJS.register(\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend\r\n);\r\n\r\ninterface MetricsChartProps {\r\n  data: SystemMetrics;\r\n}\r\n\r\ninterface ChartData {\r\n  labels: string[];\r\n  datasets: Array<{\r\n    label: string;\r\n    data: number[];\r\n    borderColor: string;\r\n    backgroundColor: string;\r\n    fill: boolean;\r\n    tension: number;\r\n    borderWidth: number;\r\n  }>;\r\n}\r\n\r\nconst MetricsChart: React.FC<MetricsChartProps> = ({ data }) => {\r\n  const theme = useTheme();\r\n  const [chartData, setChartData] = useState<ChartData>({\r\n    labels: [],\r\n    datasets: [],\r\n  });\r\n\r\n  const bytesToMbps = (bytes: number): number => {\r\n    return Number((bytes * 8 / 1000000).toFixed(2));\r\n  };\r\n\r\n  const bytesToGB = (bytes: number): number => {\r\n    return Number((bytes / (1024 * 1024 * 1024)).toFixed(2));\r\n  };\r\n\r\n  useEffect(() => {\r\n    setChartData(prevData => {\r\n      const now = new Date();\r\n      const labels = [\r\n        ...((prevData.labels as string[]).slice(-19)),\r\n        now.toLocaleTimeString('ja-JP')\r\n      ];\r\n\r\n      const cpuData = [...(prevData.datasets[0]?.data || []).slice(-19), data.cpu.usage].slice(-20);\r\n      const memoryData = [...(prevData.datasets[1]?.data || []).slice(-19), \r\n        (data.memory.used / data.memory.total) * 100].slice(-20);\r\n      const networkInData = [...(prevData.datasets[2]?.data || []).slice(-19), \r\n        bytesToMbps(data.network.bytesIn)].slice(-20);\r\n      const networkOutData = [...(prevData.datasets[3]?.data || []).slice(-19), \r\n        bytesToMbps(data.network.bytesOut)].slice(-20);\r\n\r\n      return {\r\n        labels,\r\n        datasets: [\r\n          {\r\n            label: 'CPU使用率 (%)',\r\n            data: cpuData,\r\n            borderColor: theme.palette.primary.main,\r\n            backgroundColor: theme.palette.primary.light,\r\n            fill: false,\r\n            tension: 0.4,\r\n            borderWidth: 2,\r\n          },\r\n          {\r\n            label: 'メモリ使用率 (%)',\r\n            data: memoryData,\r\n            borderColor: theme.palette.secondary.main,\r\n            backgroundColor: theme.palette.secondary.light,\r\n            fill: false,\r\n            tension: 0.4,\r\n            borderWidth: 2,\r\n          },\r\n          {\r\n            label: 'ネットワーク受信 (Mbps)',\r\n            data: networkInData,\r\n            borderColor: theme.palette.success.main,\r\n            backgroundColor: theme.palette.success.light,\r\n            fill: false,\r\n            tension: 0.4,\r\n            borderWidth: 2,\r\n          },\r\n          {\r\n            label: 'ネットワーク送信 (Mbps)',\r\n            data: networkOutData,\r\n            borderColor: theme.palette.warning.main,\r\n            backgroundColor: theme.palette.warning.light,\r\n            fill: false,\r\n            tension: 0.4,\r\n            borderWidth: 2,\r\n          }\r\n        ],\r\n      };\r\n    });\r\n  }, [data, theme.palette]);\r\n\r\n  const options: ChartOptions<'line'> = {\r\n    responsive: true,\r\n    maintainAspectRatio: false,\r\n    animation: {\r\n      duration: 300,\r\n    },\r\n    scales: {\r\n      y: {\r\n        beginAtZero: true,\r\n        grid: {\r\n          color: 'rgba(0, 0, 0, 0.05)',\r\n        },\r\n        ticks: {\r\n          callback: function(value) {\r\n            return value.toString();\r\n          },\r\n          color: theme.palette.text.secondary,\r\n        },\r\n      },\r\n      x: {\r\n        grid: {\r\n          display: false,\r\n        },\r\n        ticks: {\r\n          color: theme.palette.text.secondary,\r\n          maxRotation: 45,\r\n          minRotation: 45,\r\n        },\r\n      },\r\n    },\r\n    plugins: {\r\n      legend: {\r\n        position: 'top',\r\n        labels: {\r\n          usePointStyle: true,\r\n          padding: 20,\r\n          font: {\r\n            size: 12,\r\n          },\r\n          color: theme.palette.text.primary,\r\n        },\r\n      },\r\n      title: {\r\n        display: false,\r\n      },\r\n      tooltip: {\r\n        mode: 'index',\r\n        intersect: false,\r\n        backgroundColor: 'rgba(255, 255, 255, 0.9)',\r\n        titleColor: theme.palette.text.primary,\r\n        bodyColor: theme.palette.text.secondary,\r\n        borderColor: 'rgba(0, 0, 0, 0.1)',\r\n        borderWidth: 1,\r\n      },\r\n    },\r\n    interaction: {\r\n      mode: 'nearest',\r\n      axis: 'x',\r\n      intersect: false,\r\n    },\r\n  };\r\n\r\n  return (\r\n    <Box sx={{ \r\n      width: '100%', \r\n      height: 400,\r\n      p: 2,\r\n      backgroundColor: '#ffffff',\r\n      borderRadius: 1,\r\n      boxShadow: '0 0 10px rgba(0,0,0,0.1) inset'\r\n    }}>\r\n      <Line data={chartData} options={options} />\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default MetricsChart;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}